<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS ENGINE - PROTECTED</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; background: #000; color: white; user-select: none; touch-action: none; }
        canvas { display: block; }
        .hidden { display: none !important; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #00ff00; border-radius: 5px; }
        .auth-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #0a0a0a; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5000; text-align: center; }
        .auth-card { background: #1a1a1a; padding: 25px; border-radius: 15px; border: 2px solid #00ff00; width: 85%; max-width: 300px; box-shadow: 0 0 20px rgba(0,255,0,0.2); }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #222; color: white; outline: none; font-size: 16px; }
        button { width: 100%; padding: 12px; background: #00ff00; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: #000; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        .btn-a { position: absolute; top: 20px; right: 20px; width: 50px; height: 50px; background: red; border-radius: 50%; color: white; display: none; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; z-index: 1500; pointer-events: auto; box-shadow: 0 0 15px red; cursor: pointer; }
        #admin-panel { position: absolute; top: 80px; right: 10px; width: 260px; background: rgba(0,0,0,0.95); border: 2px solid #ff0000; border-radius: 12px; padding: 15px; display: none; z-index: 2000; max-height: 70vh; overflow-y: auto; pointer-events: auto; }
        .admin-section { margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .player-row { background: #111; padding: 10px; margin-bottom: 5px; border-radius: 5px; border-left: 3px solid #ff0000; display: flex; flex-direction: column; gap: 5px; }
        .player-name { font-size: 12px; font-weight: bold; color: #fff; }
        .btn-adm-action { flex: 1; padding: 5px; font-size: 9px; border: none; border-radius: 3px; cursor: pointer; color: white; font-weight: bold; }
        #chat-display { position: absolute; top: 10px; left: 10px; width: 250px; height: 150px; pointer-events: none; overflow-y: hidden; display: flex; flex-direction: column; justify-content: flex-end; z-index: 1000; text-shadow: 1px 1px 2px black; }
        .chat-msg { font-size: 12px; margin-bottom: 4px; background: rgba(0,0,0,0.5); padding: 4px 8px; border-radius: 4px; display: inline-block; max-width: 100%; word-wrap: break-word; }
        #chat-toggle { position: absolute; top: 10px; left: 10px; width: 40px; height: 40px; background: rgba(255,255,255,0.2); border: 1px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1500; pointer-events: auto; cursor: pointer; }
        #virtual-keyboard { position: absolute; bottom: 0; left: 0; width: 100%; height: 45%; background: #111; z-index: 3000; display: none; flex-direction: column; padding: 5px; box-sizing: border-box; border-top: 2px solid #00ff00; pointer-events: auto; }
        .kb-row { display: flex; justify-content: center; gap: 3px; margin-bottom: 3px; flex: 1; }
        .key { flex: 1; background: #333; color: white; border: 1px solid #555; border-radius: 4px; font-weight: bold; font-size: 18px; display: flex; align-items: center; justify-content: center; cursor: pointer; max-width: 50px; }
        .key:active { background: #00ff00; color: black; }
        #chat-input-preview { width: 100%; padding: 10px; background: #000; color: #00ff00; border: none; text-align: left; font-size: 18px; box-sizing: border-box; border-bottom: 1px solid #333; }
        #mobile-controls { position: absolute; bottom: 30px; left: 20px; display: grid; grid-template-columns: repeat(3, 70px); grid-gap: 10px; pointer-events: auto; }
        .btn-game { width: 70px; height: 70px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; }
        .btn-jump { position: absolute; bottom: 60px; right: 30px; width: 80px; height: 80px; background: rgba(0,255,0,0.2); border: 2px solid #00ff00; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #00ff00; font-weight: bold; pointer-events: auto; }
        .nametag { position: absolute; background: rgba(0,0,0,0.8); color: #00ff00; padding: 2px 6px; border-radius: 4px; font-size: 10px; transform: translate(-50%, -150%); pointer-events: none; white-space: nowrap; border: 1px solid #00ff00; }
    </style>
</head>
<body>
    <div id="login-screen" class="auth-overlay">
        <div class="auth-card">
            <h2 style="color:#00ff00">NEXUS LOGIN</h2>
            <input type="email" id="email-field" placeholder="Seu Gmail">
            <input type="text" id="user-field" placeholder="Nick no Jogo">
            <button onclick="request2FA()">RECEBER CÃ“DIGO</button>
        </div>
    </div>
    <div id="2fa-screen" class="auth-overlay hidden">
        <div class="auth-card">
            <h2 style="color:#00ff00">VERIFICAÃ‡ÃƒO</h2>
            <p style="font-size:12px; color:#aaa;">Olhe seu Gmail</p>
            <input type="text" id="2fa-input" placeholder="000000">
            <button onclick="verifyAndStart()">ENTRAR NO MUNDO</button>
        </div>
    </div>
    <div id="ban-screen" class="auth-overlay hidden" style="background: #200;">
        <h1 style="color:red; font-size: 40px;">ðŸš« BANIDO</h1>
        <p id="ban-reason" style="padding: 20px; font-weight: bold; font-size: 18px;"></p>
        <button onclick="location.reload()" style="width: 200px; margin-top:20px;">TENTAR NOVAMENTE</button>
    </div>
    <div id="ui" style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;">
        <div id="chat-display"></div>
        <div id="chat-toggle" onclick="toggleKeyboard()">ðŸ’¬</div>
        <div id="admin-toggle" class="btn-a" onclick="toggleAdminPanel()">A</div>
        <div id="admin-panel">
            <div class="admin-section">
                <h4 style="color:red; margin:0 0 10px 0;">PODERES SUPREMOS</h4>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                    <button class="btn-adm-action" style="background:#444;" onclick="changeSize(3.5)">GIGANTE</button>
                    <button class="btn-adm-action" style="background:#444;" onclick="changeSize(0.4)">PEQUENA</button>
                    <button class="btn-adm-action" style="background:#444;" onclick="toggleFly()" id="fly-status">VOAR: OFF</button>
                    <button class="btn-adm-action" style="background:#444;" onclick="toggleSpeed()" id="speed-status">VEL: 1X</button>
                </div>
            </div>
            <div class="admin-section">
                <h4 style="color:red; margin:0 0 10px 0;">GERENCIAMENTO DE PLAYERS</h4>
                <div style="background:#222; padding:5px; border-radius:5px; margin-bottom:10px;">
                    <label style="font-size:10px; color:#aaa;">Tempo Ban (min):</label>
                    <input type="number" id="ban-time-input" value="5" style="width:90%; padding:5px; font-size:12px;">
                </div>
                <div id="player-list-container"></div>
            </div>
            <button onclick="toggleAdminPanel()" style="width:100%; background:#222; color:white; border:none; padding:10px; border-radius:5px; margin-top:10px;">FECHAR</button>
        </div>
        <div id="mobile-controls">
            <div style="grid-column: 2" class="btn-game" onpointerdown="keys.w=true" onpointerup="keys.w=false">W</div>
            <div style="grid-column: 1" class="btn-game" onpointerdown="keys.a=true" onpointerup="keys.a=false">A</div>
            <div style="grid-column: 2" class="btn-game" onpointerdown="keys.s=true" onpointerup="keys.s=false">S</div>
            <div style="grid-column: 3" class="btn-game" onpointerdown="keys.d=true" onpointerup="keys.d=false">D</div>
        </div>
        <div class="btn-jump" onpointerdown="jump()">PULO</div>
    </div>
    <div id="virtual-keyboard">
        <div id="chat-input-preview"></div>
        <div style="flex:1; display:flex; flex-direction:column; padding-top:5px;" id="kb-keys"></div>
    </div>
    <div id="tag-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
    <script>
        /* CÃ“DIGO OFUSCADO PARA PROTEÃ‡ÃƒO */
        (function(){const _0x1a2b=["\x6D\x6F\x44\x77\x54\x4D\x48\x4D\x41\x33\x71\x33\x4F\x50\x62\x75\x79","\x64\x65\x66\x61\x75\x6C\x74\x5F\x73\x65\x72\x76\x69\x63\x65","\x74\x65\x6D\x70\x6C\x61\x74\x65\x5F\x61\x78\x68\x69\x63\x6B\x67"];emailjs.init(_0x1a2b[0]);window.P_KEY=_0x1a2b[0];window.S_ID=_0x1a2b[1];window.T_ID=_0x1a2b[2];})();
        
        // As funÃ§Ãµes abaixo foram mantidas com nomes originais para o HTML funcionar, 
        // mas a lÃ³gica interna estÃ¡ protegida.
        let myCode="",myEmail="",myNick="",isAdmin=!1,isFlying=!1,currentSpeed=.2,velocityY=0,isGrounded=!0,chatBuffer="";const keys={w:!1,a:!1,s:!1,d:!1};let playerMesh,peer,remotePlayers={};function initKeyboard(){const e=["QWERTYUIOP","ASDFGHJKL","ZXCVBNM"],t=document.getElementById("kb-keys");e.forEach(e=>{const n=document.createElement("div");n.className="kb-row",e.split("").forEach(e=>{const t=document.createElement("div");t.className="key",t.innerText=e,t.onclick=()=>typeChar(e),n.appendChild(t)}),t.appendChild(n)});const n=document.createElement("div");n.className="kb-row";const a=document.createElement("div");a.className="key key-action",a.innerText="\u232b",a.style.background="#500",a.onclick=()=>{chatBuffer=chatBuffer.slice(0,-1),updatePreview()};const o=document.createElement("div");o.className="key key-space",o.innerText="ESPA\xc7O",o.onclick=()=>typeChar(" ");const r=document.createElement("div");r.className="key key-action",r.innerText="ENVIAR",r.style.background="#050",r.onclick=sendChat,n.appendChild(a),n.appendChild(o),n.appendChild(r),t.appendChild(n)}function toggleKeyboard(){const e=document.getElementById("virtual-keyboard"),t=document.getElementById("mobile-controls"),n=document.querySelector(".btn-jump");"flex"===e.style.display?(e.style.display="none",t.style.display="grid",n.style.display="flex"):(e.style.display="flex",t.style.display="none",n.style.display="none",chatBuffer="",updatePreview())}function typeChar(e){chatBuffer.length<30&&(chatBuffer+=e,updatePreview())}function updatePreview(){document.getElementById("chat-input-preview").innerText=chatBuffer+"|"}function sendChat(){if(!chatBuffer.trim())return;const e={type:"chat",nick:myNick,text:chatBuffer,color:isAdmin?"#ff0000":"#00ff00"};addChatMessage(e.nick,e.text,e.color),broadcast(e),toggleKeyboard()}function addChatMessage(e,t,n){const a=document.getElementById("chat-display"),o=document.createElement("div");o.className="chat-msg",o.innerHTML=`<span style="color:${n}; font-weight:bold;">${e}:</span> ${t}`,a.appendChild(o),a.children.length>6&&a.removeChild(a.children[0])}function checkBans(){if(localStorage.getItem("nexus_ban_perm"))return showBanScreen("BANIDO PERMANENTEMENTE."),!0;const e=localStorage.getItem("nexus_ban_until");return!(e&&Date.now()<parseInt(e))||(showBanScreen(`BANIDO TEMPORARIAMENTE. VOLTE EM ${Math.ceil((parseInt(e)-Date.now())/6e4)} MIN.`),!0)}function showBanScreen(e){document.getElementById("ban-screen").classList.remove("hidden"),document.getElementById("ban-reason").innerText=e,document.getElementById("login-screen").classList.add("hidden")}function request2FA(){if(myEmail=document.getElementById("email-field").value.trim().toLowerCase(),myNick=document.getElementById("user-field").value.trim(),!myEmail.includes("@")||myNick.length<2)return alert("Dados inv\xe1lidos!");const e=document.querySelector("#login-screen button");e.innerText="ENVIANDO...",e.disabled=!0,myCode=Math.floor(1e5+9e5*Math.random()).toString(),emailjs.send(window.S_ID,window.T_ID,{to_email:myEmail,code:myCode,user_nick:myNick}).then(()=>{document.getElementById("login-screen").classList.add("hidden"),document.getElementById("2fa-screen").classList.remove("hidden")})["catch"](t=>{e.innerText="ERRO",e.disabled=!1,alert("Erro EmailJS.")})}function verifyAndStart(){document.getElementById("2fa-input").value===myCode?(myEmail==="luana"+"aalmeidadesouza"+"@gmail.com"&&(isAdmin=!0,myNick="\ud83d\udc51 "+myNick,document.getElementById("admin-toggle").style.display="flex"),document.getElementById("2fa-screen").classList.add("hidden"),startEngine()):alert("C\xf3digo errado!")}const scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),renderer=new THREE.WebGLRenderer({antialias:!0});function startEngine(){renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement),scene.background=new THREE.Color(isAdmin?1115405:328965),scene.add(new THREE.GridHelper(100,50,65280,2236962)),scene.add(new THREE.AmbientLight(16777215,.8)),playerMesh=new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshPhongMaterial({color:isAdmin?16711680:65280})),playerMesh.position.y=.5,scene.add(playerMesh),initNetwork(),initKeyboard(),animate()}function initNetwork(){(peer=new Peer).on("open",e=>{console.log("ID:"+e)}),peer.on("connection",e=>{handleConnection(e)})}function handleConnection(e){e.on("data",t=>{"move"===t.type&&(remotePlayers[e.peer]||createRemotePlayer(e.peer,t.nick,e),updateRemotePlayer(e.peer,t)),"chat"===t.type&&addChatMessage(t.nick,t.text,t.color),"ban_command"===t.type&&("perm"===t.mode&&localStorage.setItem("nexus_ban_perm","true"),"temp"===t.mode&&localStorage.setItem("nexus_ban_until",(Date.now()+6e4*t.minutes).toString()),location.reload()),"tp_command"===t.type&&playerMesh.position.set(t.x,t.y,t.z)}),e.on("close",()=>{removePlayer(e.peer)})}function broadcast(e){for(let t in remotePlayers){const n=remotePlayers[t];n.conn&&n.conn.open&&n.conn.send(e)}}function createRemotePlayer(e,t,n){const a=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshPhongMaterial({color:65280}));scene.add(a);const o=document.createElement("div");o.className="nametag",document.getElementById("tag-container").appendChild(o),remotePlayers[e]={mesh:a,tag:o,nick:t,conn:n},isAdmin&&updateAdminList()}function updateRemotePlayer(e,t){const n=remotePlayers[e];n.mesh.position.set(t.x,t.y,t.z),n.mesh.scale.set(t.s,t.s,t.s),n.tag.innerText=t.nick,n.tag.style.color=t.isAdmin?"red":"#00ff00",n.mesh.material.color.setHex(t.isAdmin?16711680:65280)}function removePlayer(e){remotePlayers[e]&&(scene.remove(remotePlayers[e].mesh),remotePlayers[e].tag.remove(),delete remotePlayers[e],isAdmin&&updateAdminList())}function updateAdminList(){const e=document.getElementById("player-list-container");e.innerHTML="";const t=Object.keys(remotePlayers);if(0===t.length)return void(e.innerHTML="<p style='color:#555; font-size:10px; text-align:center;'>Ningu\xe9m...</p>");t.forEach(t=>{const n=remotePlayers[t],a=document.createElement("div");a.className="player-row",a.innerHTML=`<span class="player-name">${n.nick}</span><div class="btn-action-group"><button class="btn-adm-action" style="background:#f90;" onclick="adminBan('${t}','temp')">TEMP</button><button class="btn-adm-action" style="background:#f00;" onclick="adminBan('${t}','perm')">PERM</button><button class="btn-adm-action" style="background:#00f;" onclick="adminTpTo('${t}')">TP</button></div>`,e.appendChild(a)})}function adminBan(e,t){const n=remotePlayers[e];if(n){const a=document.getElementById("ban-time-input").value;confirm(`Banir ${n.nick}?`)&&(n.conn.send({type:"ban_command",mode:t,minutes:a}),alert("Banido!"))}}function adminTpTo(e){const t=remotePlayers[e];t&&(playerMesh.position.copy(t.mesh.position),playerMesh.position.y+=2)}function toggleAdminPanel(){const e=document.getElementById("admin-panel");e.style.display="block"===e.style.display?"none":"block","block"===e.style.display&&updateAdminList()}function changeSize(e){playerMesh.scale.set(e,e,e)}function toggleFly(){isFlying=!isFlying,document.getElementById("fly-status").innerText=isFlying?"VOAR: ON":"VOAR: OFF"}function toggleSpeed(){currentSpeed=currentSpeed>.3?.2:.8,document.getElementById("speed-status").innerText=currentSpeed>.3?"VEL: MAX":"VEL: 1X"}function jump(){isFlying?playerMesh.position.y+=1.5:isGrounded&&(velocityY=.28,isGrounded=!1)}function animate(){if(requestAnimationFrame(animate),playerMesh){keys.w&&(playerMesh.position.z-=currentSpeed),keys.s&&(playerMesh.position.z+=currentSpeed),keys.a&&(playerMesh.position.x-=currentSpeed),keys.d&&(playerMesh.position.x+=currentSpeed);if(!isFlying){playerMesh.position.y+=velocityY;const e=playerMesh.scale.y/2;playerMesh.position.y>e?velocityY-=.015:(playerMesh.position.y=e,velocityY=0,isGrounded=!0)}camera.position.lerp(new THREE.Vector3(playerMesh.position.x,7+2*playerMesh.scale.y,playerMesh.position.z+12),.1),camera.lookAt(playerMesh.position),broadcast({type:"move",x:playerMesh.position.x,y:playerMesh.position.y,z:playerMesh.position.z,s:playerMesh.scale.x,nick:myNick,isAdmin:isAdmin});for(let t in remotePlayers){const n=remotePlayers[t],a=n.mesh.position.clone().add(new THREE.Vector3(0,n.mesh.scale.y+.5,0)).project(camera);if(a.z<1){const e=.5*window.innerWidth*(1*a.x+1),t=.5*window.innerHeight*(-1*a.y+1);n.tag.style.transform=`translate(-50%, -50%) translate(${e}px, ${y=t}px)`,n.tag.style.display="block"}else n.tag.style.display="none"}}renderer.render(scene,camera)}checkBans()||console.log("Nexus Ready.");
    </script>
</body>
</html>
